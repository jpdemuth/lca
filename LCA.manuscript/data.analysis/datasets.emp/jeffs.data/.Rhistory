#print(census)
}
y <- as.bigq(sum(census[,2]))
print(y)
L <- 20
M <- 96
M <- M-1
foo2 <- census <- list()
census[[1]] <- as.bigq(1)
i <- 1
foo <- foo2
L <- 20
M <- 96
M <- M-1
foo2 <- census <- list()
census[[1]] <- as.bigq(1)
i <- 1
foo[[1]] <- 43
foo <- list()
foo[[1]] <- 2
foo[[2]] <- 2
foo[[3]] <- 2
sum(foo)
sum(foo[[1:3]])
sum(unlist(foo))
unlist(foo)
unlist(foo)[2:3]
L <- 19
M <- 100
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
foo[1, 2] <- sum(census[2:L,2])
}
census <- foo
#print(census)
}
y <- as.bigq(sum(census[,2]))
print(y)
L <- 19
M <- 10
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
foo[1, 2] <- sum(census[2:L,2])
}
census <- foo
print(census)
}
y <- as.bigq(sum(census[,2]))
print(y)
L <- 19
M <- 10
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
}
foo[1, 2] <- sum(census[2:L,2])
census <- foo
print(census)
}
y <- as.bigq(sum(census[,2]))
print(y)
L <- 19
M <- 100
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
}
foo[1, 2] <- sum(census[2:L,2])
census <- foo
print(census)
}
y <- as.bigq(sum(census[,2]))
print(y)
L <- 19
M <- 100
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
}
foo[1, 2] <- sum(census[2:L,2])
census <- foo
print(census)
}
x <- as.bigq(sum(census[,2]))
y <- sum(as.bigq(census[,2]))
print(x)
print(y)
L <- 19
M <- 100
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
}
foo[1, 2] <- sum(census[2:L,2])
census <- foo
print(census)
}
x <- as.bigq(sum(census[,2]))
y <- sum(as.bigq(census[,2]))
print(x)
print(y)
L <- 16
M <- 83
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
}
foo[1, 2] <- sum(census[2:L,2])
census <- foo
print(census)
}
x <- as.bigq(sum(census[,2]))
y <- sum(as.bigq(census[,2]))
print(x)
print(y)
L <- 3
M <- 6
M <- M-1
foo2 <- census <- matrix(c(1:L, rep(0, L)),L,2)
census[1, 2] <- 1
for(i in 1:M){
foo <- foo2
#print(paste("Month:", i))
for(j in 2:L){
foo[j, 2] <- census[(j-1), 2]
}
foo[1, 2] <- sum(census[2:L,2])
census <- foo
print(census)
}
x <- as.bigq(sum(census[,2]))
y <- sum(as.bigq(census[,2]))
print(x)
print(y)
L <- 20
M <- 96
M <- M-1
foo2 <- census <- list()
census[[1]] <- as.bigq(1)
for(i in 1:M){
foo <- foo2
for(j in 2:L){
foo[[j]] <- census[[j-1]]
}
foo[[1]] <- sum(unlist(census)[2:L]]
census <- foo
L <- 20
M <- 96
M <- M-1
foo2 <- census <- list()
census[[1]] <- as.bigq(1)
for(i in 1:M){
foo <- foo2
for(j in 2:L){
foo[[j]] <- census[[j-1]]
}
foo[[1]] <- sum(unlist(census)[2:L]
census <- foo
}
y <- sum(unlist(census))
print(y)
L <- 20
M <- 96
M <- M-1
foo2 <- census <- list()
census[[1]] <- as.bigq(1)
for(i in 1:M){
foo <- foo2
for(j in 2:L){
foo[[j]] <- census[[j-1]]
}
foo[[1]] <- sum(unlist(census)[2:L])
census <- foo
}
y <- sum(unlist(census))
print(y)
L <- 20
M <- 96
M <- M-1
foo2 <- census <- list()
census[[1]] <- as.bigq(1)
i <- 1
foo <- foo2
j <- 2
foo[[1]] <- 0
for(j in 2:L){
foo[[j]] <- census[[j-1]]
}
foo2 <- census <- list(length=L)
census[[1]] <- as.bigq(1)
for(i in 1:M){
foo <- foo2
foo[[1]] <- 0
for(j in 2:L){
foo[[j]] <- census[[j-1]]
}
foo[[1]] <- sum(unlist(census)[2:L])
census <- foo
}
W <- vector("list", 602)
foo2 <- census <- vector("list", L)
L <- 20
M <- 96
M <- M-1
foo2 <- census <- vector("list", L)
census[[1]] <- as.bigq(1)
for(i in 1:M){
foo <- foo2
foo[[1]] <- 0
for(j in 2:L){
foo[[j]] <- census[[j-1]]
}
foo[[1]] <- sum(unlist(census)[2:L])
census <- foo
}
y <- sum(unlist(census))
print(y)
unlist(census)
unlist(census)[2:L]
census
L <- 20
M <- 96
M <- M-1
foo2 <- census <- vector("list", L)
census[[1]] <- as.bigq(1)
census
foo <- foo2
foo[[1]] <- 0
foo[[1]] <- as.bigq(0)
census
foo
j <- 2
census[[j-1]]
foo[[j]] <- census[[j-1]]
foo
unlist(census)
census[[1]]
census[[2]]
unlist(census)
sum(unlist(census))
census[[1]]
census[[1]]->x
census[[1]]->y
x + y
length(census)
for(i in 1:length(census)){
bar[i] <- census[i]
}
bar <- vector()
for(i in 1:length(census)){
bar[i] <- census[i]
}
bar <- vector()
for(i in 1:length(census)){
bar[i] <- census[[i]]
}
sum(census[1:3])
L <- 20
M <- 96
M <- M-1
foo2 <- census <- vector("list", L)
census[[1]] <- as.bigz(1)
for(i in 1:M){
foo <- foo2
foo[[1]] <- as.bigz(0)
for(j in 2:L){
foo[[j]] <- census[[j-1]]
}
bar <- vector()
for(i in 1:length(census)){
bar[i] <- census[[i]]
}
census <- foo
}
y <- sum(unlist(census))
print(y)
y <- add.bigz(census)
y <- add.bigz(unlist(census))
unlist(census)
37450/2
.2^5
.2^6
99660/2
sqrt(1/2)
1 - .5^2
(1 - .5^2) * (1-.2^2)
(1 - .5^2) * (.2^2)
(.5^2) * (1-.2^2)
(.5^2) * (.2^2)
(1 - .5^2) * (1-.2^2) * 95
(1 - .5^2) * (.2^2) * 38
(.5^2) * (1-.2^2) * 90
(.5^2) * (.2^2) * 33
(1 - .5^2) * (1-.2^2) * 95 +
(1 - .5^2) * (.2^2) * 38 +
(.5^2) * (1-.2^2) * 90 +
(.5^2) * (.2^2) * 33
95*.4
38*.1
90*.4
33*.1
95*.4 +
38*.1 +
90*.4 +
33*.1
91.47-81.1
95-38
57*.2
2*.25*2.5
2*.64*11.4
91.47-20.74
library("evobiR", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("taxize", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("rgbif", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
install.packages("rgbif")
library("taxize", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("rgdal", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
install.packages("rgdal")
library("rgdal", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("taxize", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
library("evobiR", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
system.file("3.fasta")
system.file("3.fasta", package="evobiR")
read.fasta(system.file("3.fasta", package='evobiR'))->fii
readFasta(system.file("3.fasta", package='evobiR'))->fii
CalcPopD
read.alignment(system.file("3.fasta", package='evobiR'))->fii
read.alignment(system.file("3.fasta", package='evobiR'), format='fasta')->fii
install.packages("evobiR")
citation(geiger)
citation("geiger")
library(evobiR)
CoalSim(census = 15, lw = 2, ln.col = 'blue')
CoalSim(census = 15, lw = 2, ln.col = 'blue')
foo <- c(1,2,3,4,5)
mode(foo)
Mode(foo)
?subplex
??subplex
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
lm(x~y)
foo <- lm(x~y)
foo
summary(foo)
foo <- lm(y~x)
summary(foo)
data(mtcars)
mtcars
mtcars$mpg
foo <- lm(mtcars$mpg~mtcars$wt)
summary(foo)
mean(mtcars$wt)
plot(x=mtcars$wt,y=mtcars$mpg)
predict.lm(foo,mean(mtcars$wt))
predict.lm(foo)
setwd("~/Desktop/Dropbox/papers/LCA")
library(devtools)
install("SAGA")
library(SAGA)
help(AnalyzeCrossesMM)
help(DisplayCmatrix)
help(EvaluateModel)
help(VisModelSpace)
help(AnalyzeCrossesMM)
help(DisplayCmatrix)
setwd("~/Desktop/Dropbox/papers/LCA/datasets/jeffs.data")
identities <- c(3, 6, 9, 12, 15, 21, 18, 24, 27, 30, 33, 36, 45, 48, 39, 42)
data1 <- cbind(identities, read.csv("ban.osa.csv", row.names = 1, header = F)[, 1:2])
data2 <- cbind(identities, read.csv("col.ban.csv", row.names = 1, header = F)[, 1:2])
data3 <- cbind(identities, read.csv("dar.bho.csv", row.names = 1, header = F)[, 1:2])
data4 <- cbind(identities, read.csv("nig.sing.csv", row.names = 1, header = F)[, 1:2])
data5 <- cbind(identities, read.csv("pm.sin.csv", row.names = 1, header = F)[, 1:2])
data6 <- cbind(identities, read.csv("nig.cro.csv", row.names = 1, header = F)[, 1:2])
data7 <- cbind(identities, read.csv("per.inf.csv", row.names = 1, header = F)[, 1:2])
data8 <- cbind(identities, read.csv("osa.col.csv", row.names = 1, header = F)[, 1:2])
data9 <- cbind(identities, read.csv("cro.inf.csv", row.names = 1, header = F)[, 1:2])
data10 <- cbind(identities, read.csv("per.sq.csv", row.names = 1, header = F)[, 1:2])
data11 <- cbind(identities, read.csv("sin.cro.csv", row.names = 1, header = F)[, 1:2])
data12 <- cbind(identities, read.csv("ba.sq.csv", row.names = 1, header = F)[, 1:2])
data13 <- cbind(identities, read.csv("bh.sq.csv", row.names = 1, header = F)[, 1:2])
data14 <- cbind(identities, read.csv("da.sq.csv", row.names = 1, header = F)[, 1:2])
data15 <- cbind(identities, read.csv("ban.inf.csv", row.names = 1, header = F)[, 1:2])
setwd("~/Desktop/Dropbox/papers/LCA/results/jeff")
i <- 1
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
i <- 9
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
i <- 11
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
i <- 1
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
# Heath Blackmon
# 11 Sept 2014
# Script for testing functions in SAGA
# First install the package
setwd("~/Desktop/Dropbox/papers/LCA")
library(devtools)
install("SAGA")
library(SAGA)
# Now run tests included in each function
# First load Lynch and Walsh plant height data
data(PH)
# Primary analysis function with various argument options
results <- AnalyzeCrossesMM(PH, model.sum = .25, graph=T) # small conf set of models
results <- AnalyzeCrossesMM(PH, model.sum = .99, graph=T) # large conf set of models
results <- AnalyzeCrossesMM(PH, model.sum = .99, max.models = 10, graph=T) # restrict number of mod to store
results <- AnalyzeCrossesMM(PH, model.sum = .05, graph=T) # single model result
results <- AnalyzeCrossesMM(PH, even.sex=T, graph=F) # equal sex ratio
# Function to return the cmatrix being used
cmat <- DisplayCmatrix("MP")
# Function to display the result of a specific model
EvaluateModel(data=results, model=3)
# Function to display model space
VisModelSpace(data=results, cex.u=3)
# Check the help files
help(AnalyzeCrossesMM)
help(DisplayCmatrix)
help(EvaluateModel)
help(VisModelSpace)
# Lets check some of jeffs data
setwd("~/Desktop/Dropbox/papers/LCA/datasets/jeffs.data")
identities <- c(3, 6, 9, 12, 15, 21, 18, 24, 27, 30, 33, 36, 45, 48, 39, 42)
# Jeff's 29C cohorts
data1 <- cbind(identities, read.csv("ban.osa.csv", row.names = 1, header = F)[, 1:2])
data2 <- cbind(identities, read.csv("col.ban.csv", row.names = 1, header = F)[, 1:2])
data3 <- cbind(identities, read.csv("dar.bho.csv", row.names = 1, header = F)[, 1:2])
data4 <- cbind(identities, read.csv("nig.sing.csv", row.names = 1, header = F)[, 1:2])
data5 <- cbind(identities, read.csv("pm.sin.csv", row.names = 1, header = F)[, 1:2])
data6 <- cbind(identities, read.csv("nig.cro.csv", row.names = 1, header = F)[, 1:2])
data7 <- cbind(identities, read.csv("per.inf.csv", row.names = 1, header = F)[, 1:2])
data8 <- cbind(identities, read.csv("osa.col.csv", row.names = 1, header = F)[, 1:2])
data9 <- cbind(identities, read.csv("cro.inf.csv", row.names = 1, header = F)[, 1:2])
data10 <- cbind(identities, read.csv("per.sq.csv", row.names = 1, header = F)[, 1:2])
data11 <- cbind(identities, read.csv("sin.cro.csv", row.names = 1, header = F)[, 1:2])
data12 <- cbind(identities, read.csv("ba.sq.csv", row.names = 1, header = F)[, 1:2])
data13 <- cbind(identities, read.csv("bh.sq.csv", row.names = 1, header = F)[, 1:2])
data14 <- cbind(identities, read.csv("da.sq.csv", row.names = 1, header = F)[, 1:2])
data15 <- cbind(identities, read.csv("ban.inf.csv", row.names = 1, header = F)[, 1:2])
i <- 1
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
i <- 3
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
i <- 7
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
i <- 11
foo <- AnalyzeCrossesMM(get(paste("data", i, sep="")), Cmatrix = "MP",
model.sum = 0.95, even.sex = F,
graph=T, max.models = 70000)
cmat <- DisplayCmatrix("MP")
# Function to display the result of a specific model
EvaluateModel(data=results, model=3)
results <- AnalyzeCrossesMM(PH, model.sum = .25, graph=T) # small conf set of models
data(PH)
# Primary analysis function with various argument options
results <- AnalyzeCrossesMM(PH, model.sum = .25, graph=T) # small conf set of models
data(SR)
results <- AnalyzeCrossesMM(SR, model.sum = .25, graph=T) # small conf set of models
VisModelSpace(data=results, cex.u=3)
VisModelSpace(data=results, cex.u=2)
help(VisModelSpace)
